package com.SVRPlatform.service.impl;

import java.util.ArrayList;
import java.util.List;

import com.SVRPlatform.dao.ExploitCommentDAO;
import com.SVRPlatform.dao.ExploitDAO;
import com.SVRPlatform.dao.UserDAO;
import com.SVRPlatform.data.ExploitCommentData;
import com.SVRPlatform.data.ExploitCommentsData;
import com.SVRPlatform.model.Exploit;
import com.SVRPlatform.model.ExploitComment;
import com.SVRPlatform.service.ExploitCommentDisplayService;

public class ExploitCommentDisplayServiceImpl implements
		ExploitCommentDisplayService {
	private UserDAO userDAO;
	private ExploitDAO exploitDAO;
	private ExploitCommentDAO exploitCommentDAO;
	

	public UserDAO getUserDAO() {
		return userDAO;
	}


	public void setUserDAO(UserDAO userDAO) {
		this.userDAO = userDAO;
	}


	public ExploitDAO getExploitDAO() {
		return exploitDAO;
	}


	public void setExploitDAO(ExploitDAO exploitDAO) {
		this.exploitDAO = exploitDAO;
	}


	public ExploitCommentDAO getExploitCommentDAO() {
		return exploitCommentDAO;
	}


	public void setExploitCommentDAO(ExploitCommentDAO exploitCommentDAO) {
		this.exploitCommentDAO = exploitCommentDAO;
	}


	@Override
	public ExploitCommentsData commentsDispalyService(int exploitId,
			int pageNumber, int commentsPerPage) {
		// TODO Auto-generated method stub
		Exploit exploit = (Exploit) exploitDAO.getByID(new Integer(exploitId));
		
		List<ExploitComment> exploitComments = exploitCommentDAO.getByExploit(exploit, -1, -1);
		ExploitCommentsData exploitCommentsData = new ExploitCommentsData();
		List<ExploitCommentData> list = new ArrayList<ExploitCommentData>();
		exploitCommentsData.setExploitCommetCount(exploitComments.size());
		for(ExploitComment sc: exploitComments){
			ExploitCommentData scd = new ExploitCommentData();
			scd.setContent(sc.getContent());
			scd.setExploitCommentID(sc.getCommentId());
			scd.setCredits(sc.getUser().getCredit());
			scd.setEmail(sc.getUser().getEmail());
			scd.setRealname(sc.getUser().getRealName());
			list.add(scd);
		}
		exploitCommentsData.setExploitCommentsData(list);
		return exploitCommentsData;
	}

}
