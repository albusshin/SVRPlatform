package com.SVRPlatform.action;

import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.ServletResponseAware;

import com.SVRPlatform.Utils.VerifyUser;
import com.SVRPlatform.constants.Constants;
import com.SVRPlatform.service.VulnerabilityDisplayService;
import com.opensymphony.xwork2.ActionSupport;

public class DisplayVulnerability extends ActionSupport implements
		ServletRequestAware, ServletResponseAware {
	/**
* 
*/
	private static final long serialVersionUID = 1L;
	private HttpServletRequest request;
	private HttpServletResponse response;
	private String strVulnerabilityNumber;
	private String strVulnerabilityDigest;
	private String strDate;
	private String strScore;
	private String strConfidentialityImpact;
	private String strIntegrityImpact;
	private String strAvailabilityImpact;
	private String strAccessComplexity;
	private String strAuthentication;
	private String strGainedAccess;
	private String strVulnerabilityType;
	private String strScreenshotPath;
	private String strVulnerabilityDescription;
	private String strCompany;
	private String strSoftware;
	private String strVersion;
	private String strLanguage;
	private String strBestExploit;
	private String strSolution;
	private String strVotedUp;
	private String strUp;
	public String getStrVulnerabilityNumber() {
		return strVulnerabilityNumber;
	}

	public void setStrVulnerabilityNumber(String strVulnerabilityNumber) {
		this.strVulnerabilityNumber = strVulnerabilityNumber;
	}

	public String getStrVulnerabilityDigest() {
		return strVulnerabilityDigest;
	}

	public void setStrVulnerabilityDigest(String strVulnerabilityDigest) {
		this.strVulnerabilityDigest = strVulnerabilityDigest;
	}

	public String getStrDate() {
		return strDate;
	}

	public void setStrDate(String strDate) {
		this.strDate = strDate;
	}

	public String getStrScore() {
		return strScore;
	}

	public void setStrScore(String strScore) {
		this.strScore = strScore;
	}

	public String getStrConfidentialityImpact() {
		return strConfidentialityImpact;
	}

	public void setStrConfidentialityImpact(String strConfidentialityImpact) {
		this.strConfidentialityImpact = strConfidentialityImpact;
	}

	public String getStrIntegrityImpact() {
		return strIntegrityImpact;
	}

	public void setStrIntegrityImpact(String strIntegrityImpact) {
		this.strIntegrityImpact = strIntegrityImpact;
	}

	public String getStrAvailabilityImpact() {
		return strAvailabilityImpact;
	}

	public void setStrAvailabilityImpact(String strAvailabilityImpact) {
		this.strAvailabilityImpact = strAvailabilityImpact;
	}

	public String getStrAccessComplexity() {
		return strAccessComplexity;
	}

	public void setStrAccessComplexity(String strAccessComplexity) {
		this.strAccessComplexity = strAccessComplexity;
	}

	public String getStrAuthentication() {
		return strAuthentication;
	}

	public void setStrAuthentication(String strAuthentication) {
		this.strAuthentication = strAuthentication;
	}

	public String getStrGainedAccess() {
		return strGainedAccess;
	}

	public void setStrGainedAccess(String strGainedAccess) {
		this.strGainedAccess = strGainedAccess;
	}

	public String getStrVulnerabilityType() {
		return strVulnerabilityType;
	}

	public void setStrVulnerabilityType(String strVulnerabilityType) {
		this.strVulnerabilityType = strVulnerabilityType;
	}

	public String getStrScreenshotPath() {
		return strScreenshotPath;
	}

	public void setStrScreenshotPath(String strScreenshotPath) {
		this.strScreenshotPath = strScreenshotPath;
	}

	public String getStrVulnerabilityDescription() {
		return strVulnerabilityDescription;
	}

	public void setStrVulnerabilityDescription(String strVulnerabilityDescription) {
		this.strVulnerabilityDescription = strVulnerabilityDescription;
	}

	public String getStrCompany() {
		return strCompany;
	}

	public void setStrCompany(String strCompany) {
		this.strCompany = strCompany;
	}

	public String getStrSoftware() {
		return strSoftware;
	}

	public void setStrSoftware(String strSoftware) {
		this.strSoftware = strSoftware;
	}

	public String getStrVersion() {
		return strVersion;
	}

	public void setStrVersion(String strVersion) {
		this.strVersion = strVersion;
	}

	public String getStrLanguage() {
		return strLanguage;
	}

	public void setStrLanguage(String strLanguage) {
		this.strLanguage = strLanguage;
	}

	public String getStrBestExploit() {
		return strBestExploit;
	}

	public void setStrBestExploit(String strBestExploit) {
		this.strBestExploit = strBestExploit;
	}

	public String getStrSolution() {
		return strSolution;
	}

	public void setStrSolution(String strSolution) {
		this.strSolution = strSolution;
	}

	public String getStrVotedUp() {
		return strVotedUp;
	}

	public void setStrVotedUp(String strVotedUp) {
		this.strVotedUp = strVotedUp;
	}

	public String getStrUp() {
		return strUp;
	}

	public void setStrUp(String strUp) {
		this.strUp = strUp;
	}

	
	
	private VulnerabilityDisplayService vulnerabilityDisplayService;

	public void setVulnerabilityDisplayService(
			VulnerabilityDisplayService vulnerabilityDisplayService) {
		this.vulnerabilityDisplayService = vulnerabilityDisplayService;
	}

	
	
	public String execute() {
		int userID = VerifyUser.getNowUserID(request);
		Map<String, String> theMap = vulnerabilityDisplayService.vulnerabilityDisplay(
				userID, strVulnerabilityNumber);
		strVulnerabilityNumber = theMap.get("strVulnerabilityNumber");
		strVulnerabilityDigest = theMap.get("strVulnerabilityDigest");
		strDate = theMap.get("strDate");
		strScore = theMap.get("strScore");
		strConfidentialityImpact = theMap.get("strConfidentialityImpact");
		strIntegrityImpact= theMap.get("strIntegrityImpact");
		strAvailabilityImpact = theMap.get("strAvailabilityImpact");
		strAccessComplexity = theMap.get("strAccessComplexity");
		strAuthentication = theMap.get("strAuthentication");
		strGainedAccess = theMap.get("strGainedAccess");
		strVulnerabilityType = theMap.get("strVulnerabilityType");
		strScreenshotPath = theMap.get("strScreenshotPath");
		strVulnerabilityDescription = theMap.get("strVulnerabilityDescription");
		strCompany = theMap.get("strCompany");
		strSoftware = theMap.get("strSoftware");
		strVersion = theMap.get("strVersion");
		strLanguage = theMap.get("strLanguage");
		strBestExploit = theMap.get("strBestExploit");
		strSolution = theMap.get("strSolution");
		strVotedUp = theMap.get("strVotedUp");
		strUp = theMap.get("strUp");
		
		if (theMap.get("status").equals("fail")) {
			// System.out.println("theMap.get('status') == fail");
			return Constants.FAIL;
		}
		// System.out.println("theMap.get('status') == success");
		
		if (theMap.containsKey("isVotedUp"))
			strVotedUp = "true";
		else
			strVotedUp = "false";

		return Constants.SUCCESS;
	}

	@Override
	public void setServletResponse(HttpServletResponse arg0) {
		// TODO Auto-generated method stub
		response = arg0;
	}

	@Override
	public void setServletRequest(HttpServletRequest arg0) {
		// TODO Auto-generated method stub
		request = arg0;
	}
}
