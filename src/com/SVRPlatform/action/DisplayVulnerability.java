package com.SVRPlatform.action;

import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts2.interceptor.ServletRequestAware;
import org.apache.struts2.interceptor.ServletResponseAware;

import com.SVRPlatform.Utils.VerifyUser;
import com.SVRPlatform.constants.Constants;
import com.SVRPlatform.service.BugInfoDisplayService;
import com.opensymphony.xwork2.ActionSupport;

public class DisplayVulnerability extends ActionSupport implements ServletRequestAware,
ServletResponseAware {
/**
* 
*/
private static final long serialVersionUID = 1L;
private HttpServletRequest request;
private HttpServletResponse response;
private String strVulnerabilityNumber;
private String strVulnerabilityDigest;
private String strDate;
private String strScore;
private String strConfidentialityImpact;
private String strIntegrityImpact;
private String strAvailabilityImpact;
private String strAccessComplexity;
private String strAuthentication;
private String strGainedAccess;
private String strVulnerabilityType;
private String strScreenshotPath;
private String strVulnerabilityDescription;
private String strCompany;
private String strSoftware;
private String strVersion;
private String strLanguage;
private String strBestExploit;
private String strSolution;
private String strVotedUp;
private String strUp;
private String strDown;
private BugInfoDisplayService bugInfoDisplayService;
public void setBugInfoDisplayService(BugInfoDisplayService bugInfoDisplayService) {
this.bugInfoDisplayService = bugInfoDisplayService;
}


public String execute(){
String nowUser = VerifyUser.getNowUser(request);
//System.out.println("DisplayBug.java execute()");
//System.out.println("firstly, the strBugNumber == " + strBugNumber);
Map<String, String> theMap = bugInfoDisplayService.bugInfoDisplay(nowUser, strBugNumber);
if (theMap.get("status").equals("fail")){
	//System.out.println("theMap.get('status') == fail");
	return Constants.FAIL;
}
//System.out.println("theMap.get('status') == success");
strBugDigest = theMap.get("strBugDigest");
strDate = theMap.get("strDate");
strScore = theMap.get("strScore");
strUsabilityImpact = theMap.get("strUsabilityImpact");
strDataImpact = theMap.get("strDataImpact");
strPrivacyImpact = theMap.get("strPrivacyImpact");
strAvailabilityImpact = theMap.get("strAvailabilityImpact");
strFrequency = theMap.get("strFrequency");
strScreenshotPath = theMap.get("strScreenshotPath");
strBugDescription = theMap.get("strBugDescription");
strCompany = theMap.get("strCompany");
strSoftware = theMap.get("strSoftware");
strVersion = theMap.get("strVersion");
strLanguage = theMap.get("strLanguage");
strBestSolution = theMap.get("strBestSolution");
strOfficialSolution = theMap.get("strOfficialSolution");
strUp = theMap.get("strUp");
strDown = theMap.get("strDown");
if (theMap.containsKey("isVotedUp"))
	strVotedUp = "true";
else strVotedUp = "false";
if (theMap.containsKey("isVotedDown"))
	strVotedDown = "true";
else strVotedDown = "false";

return Constants.SUCCESS;
}
@Override
public void setServletResponse(HttpServletResponse arg0) {

// TODO Auto-generated method stub
response = arg0;
}

@Override
public void setServletRequest(HttpServletRequest arg0) {
// TODO Auto-generated method stub
request = arg0;
}
public String getStrDown() {
return strDown;
}
public void setStrDown(String strDown) {
this.strDown = strDown;
}
public String getStrUp() {
return strUp;
}
public void setStrUp(String strUp) {
this.strUp = strUp;
}
}
