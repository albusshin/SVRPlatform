<%@ page language="java" contentType="text/html;  charset=utf-8"
    pageEncoding="utf-8"%>
   
   <!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>VULNERABILITY Details</title>
	<link rel="stylesheet" href="style.css" />
	<script type="text/javascript" src="jquery.min.js">
    </script>
</head>
<style type="text/css">
div.bugvulrating{
	height:400px;
}
</style>
<body>
	<div id="wrongmessage" class="alert-messages" style="display:none">
		<div class="message">
			<div class="message-inside">
				<div class="message-text">
				</div>
				<a class="dismiss" href="javascript:dismiss();">Ã—</a>
			</div>
		</div>
	</div>             	
	<script type="text/javascript">
    	function dismiss() {
    		document.getElementById("wrongmessage").setAttribute("style", "display:none");
    	}
    </script>
	<%
	
	String str = (String) session.getAttribute("email");
	if (str != null){
		str = "signedin";
	}
	
	%>
 		<jsp:include page="header.jsp" flush="true">
 			<jsp:param name="type" value="<%=str%>"/>
 		</jsp:include>
    <div id="content">
    		<div id="menu" class="menu">
                <ul>
                	<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
                    <li><a href="vulnerabilitypage?strVulnerabilityNumber=${strVulnerabilityNumber }">VULNERABILITY</a></li>
                    <li><a href="displayvulnerabilitycomments?strVulnerabilityNumber=${strVulnerabilityNumber }&strNowPage=1">COMMENTS</a></li>
                    <li><a href="displayvulnerabilityexploits?strVulnerabilityNumber=${strVulnerabilityNumber }&strNowPage=1#official"><image src="images/logo.png" width="54px" margin="10px"></image>EXPLOITS</a></li>
                    <li><a href="displayvulnerabilitysolution?strVulnerabilityNumber=${strVulnerabilityNumber }">SOLUTION</a></li>
                </ul>
            </div>
		<hr />
        <p class="bugvulid">
        Vulnerability Details:&nbsp;&nbsp;&nbsp;&nbsp;<a href="#" id="vulnerabilityNumber">${strVulnerabilityNumber }</a>
        </p>
        <br>
        <div class="bugvuldigest">
        ${strVulnerabilityDigest }
         <div class="date">Publish Date: ${strDate }</div>
        </div>
        <br>
        <p class="bugvulsubtitle">
        Vulnerability Rating
        </p>
        <br>
        <br>
        <div class="bugvulrating">
        	<div class="bugvulleftbar">
        		<%
        		if (((String)request.getAttribute("strVotedUp")).equals("true")) {
        			out.println("<img class=\"bugvulleftbarwatch\" src=\"images/nowwatch.png\" onmouseover=\"\" onmouseout=\"\" title=\"Watch this vulnerability\" >");
					out.println("<p class=\"bugvulleftbarwatch\" align=\"center\">"+(String)request.getAttribute("strUp")+"</p>");

        		}
        		else {
        			out.println("<img class=\"bugvulleftbarwatch\" src=\"images/watch.png\" onmouseover=\"this.src='images/watchpressed.png'\" onmouseout=\"this.src='images/watch.png'\" title=\"Watch this vulnerability\" >");
					out.println("<p class=\"bugvulleftbarwatch\" align=\"center\">"+(String)request.getAttribute("strUp")+"</p>");
        		}
        		%>
			</div>
			<div class="bugvultablediv">
		        <table class="bugvultable" align="center">
		        	<tr>
		            <td class="tableleft"> CVSS Score: </td>
		            <td class="score" align="center"> ${strScore } </td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Confidentiality Impact: </td>
		            <td class="tablemiddlegreen" align="center"> ${strConfidentialityImpact } </td>
		            <td class="tableright"> There is total information disclosure, resulting in all system files being revealed.</td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Integrity Impact: </td>
		            <td class="tablemiddleorange" align="center"> ${strIntegrityImpact } </td>
		            <td class="tableright">There is a total compromise of system integrity. There is a complete loss of system protection, resulting in the entire system being compromised.</td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Availability Impact: </td>
		            <td class="tablemiddlered" align="center"> ${strAvailabilityImpact}</td>
		            <td class="tableright">There is a total shutdown of the affected resource. The attacker can render the resource completely unavailable.</td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Access Complexity: </td>
		            <td class="tablemiddlegreen" align="center"> ${strAccessComplexity } </td>
		            <td class="tableright"> The access conditions are somewhat specialized. Some preconditions must be satistified to exploit</td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Authentication: </td>
		            <td class="tablemiddlegreen" align="center"> ${strAuthentication } </td>
		            <td class="tableright"> Authentication is not required to exploit the vulnerability.</td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Gained Access: </td>
		            <td class="tablemiddlegreen" align="center"> ${strGainedAccess } </td>
		            <td class="tableright"> &nbsp;</td>
		            </tr>
		            <tr>
		            <td class="tableleft"> Vulnerability Type: </td>
		            <td class="tablemiddlegreen" align="center"> ${strVulnerabilityType } </td>
		            <td class="tableright"> Execute Code</td>
		            </tr>
				</table>
			</div>
		</div>
        <br>
    <br>
    	<p class="bugvulsubtitle">
        Vulnerability Screenshots
        </p>
        <p class="bugvultext">
        <img src=${strScreenshotPath } class="bugvulscreenshot">
        </p>
        <p class="bugvulsubtitle">
        References For ${strVulnerabilityNumber}
        </p>
        <p class="bugvultext">
        ${strVulnerabilityDescription }
        </p>
        <p class="bugvultext">
        
        <br>
        <p class="bugvulsubtitle">
        Products Affected By ${strVulnerabilityNumber } 
        </p>
        <br>
        <br>
        <table class="productstable" align="center" border="2">
        <th>&nbsp;&nbsp;#&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Product Type&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Vendor&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Product&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Version&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Update&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Edition&nbsp;&nbsp;</th>
        <th>&nbsp;&nbsp;Language&nbsp;&nbsp;</th>
        	<tr>
            	<td align="center"> 1 </td>
                <td align="center"> Application </td>
                <td align="center"> ${strCompany } </td>
                <td align="center"> ${strSoftware } </td>
                <td align="center"> ${strVersion } </td>
                <td align="center">&nbsp; </td>
                <td align="center">&nbsp; </td>
                <td align="center"> ${strLanguage}</td>
            </tr>
        </table>	
        <br>
        <br>
        <p class="bugvulsubtitle">
        Solution 
        </p>
        <p class="bugvultext">
        ${strSolution }
		</p>
		<p class="bugvulsubtitle">
		Best Exploit
		</p>
		<p class="bugvultext">
		${strBestExploit }
		</p>
    </div>
    	<jsp:include page="/footer.jsp" flush="true"/>
</body>
</html>
